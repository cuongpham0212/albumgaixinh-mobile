# =====================================================
# ✅ NETLIFY CONFIG CHUẨN CHO HUGO WEBSITE (Mobile)
# =====================================================

[build]
  publish = "public"
  command = "hugo --gc --minify --cleanDestinationDir"
  # ⚙️ Không dùng serverless functions cho mobile
  # functions = "functions"

[build.environment]
  HUGO_VERSION = "0.149.0"
  HUGO_ENV = "production"
  HUGO_ENABLEGITINFO = "true"
  TZ = "Asia/Ho_Chi_Minh"

# =====================================================
# ✅ HTTP HEADERS (SEO & Cache)
# =====================================================

# MIME chính xác cho sitemap.xml
[[headers]]
  for = "/sitemap.xml"
  [headers.values]
    Content-Type = "application/xml; charset=UTF-8"

# Cache kiểm soát (HTML không cache, asset cache dài)
[[headers]]
  for = "/*"
  [headers.values]
    Cache-Control = "no-cache, no-store, must-revalidate"
    Pragma = "no-cache"
    Expires = "0"

[[headers]]
  for = "/css/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/js/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# =====================================================
# ✅ REDIRECTS (song song với bản desktop)
# =====================================================

# Người dùng desktop truy cập mobile → tự quay về desktop
[[redirects]]
  from = "https://albumgaixinh-mobile.netlify.app/*"
  to = "https://albumgaixinh.netlify.app/:splat"
  status = 302
  conditions = { Device = "desktop" }
  force = true
