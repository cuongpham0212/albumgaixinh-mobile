{{/* layouts/shortcodes/cdn_gallery_mobile.html */}}
{{ $page := .Page }}
{{ $thumbs := $page.Params.thumbs }}
{{ $images := $page.Params.images }}
{{ $thumbsNude := default (slice) $page.Params.thumbs_nude }}
{{ $nudes := default (slice) $page.Params.nudes }}

<!-- ========================================================= -->
<!-- ü©∂ B·ªò ·∫¢NH TH∆Ø·ªúNG -->
<!-- ========================================================= -->
{{ if and $thumbs (gt (len $thumbs) 0) }}
  <h2 class="text-lg font-semibold mt-4 mb-3 text-center text-gray-800">
    B·ªô ·∫£nh th∆∞·ªùng ({{ len $thumbs }} ·∫£nh)
  </h2>

  <div id="gallery-normal-{{ $page.File.UniqueID }}" class="grid grid-cols-2 gap-3 px-2">
    {{ range $i, $thumb := $thumbs }}
      {{ $full := cond (lt $i (len $images)) (index $images $i) $thumb }}
      <figure class="overflow-hidden rounded-lg shadow-md bg-white">
        <a href="{{ $full }}" class="block glightbox" data-gallery="gallery-normal-{{ $page.File.UniqueID }}">
          <img 
            src="{{ $thumb }}" 
            data-src="{{ $thumb }}" 
            alt="{{ $page.Title }} - ·∫£nh {{ add $i 1 }}"
            class="lazy-image w-full h-full object-cover transition-transform duration-300 hover:scale-105"
            loading="lazy">
        </a>
      </figure>

      {{/* üß© Ch√®n block qu·∫£ng c√°o Shopee ·ªü gi·ªØa (sau ·∫£nh th·ª© 8) */}}
      {{ if eq $i 7 }}
        <div class="col-span-2 rounded-xl shadow-md bg-gradient-to-r from-orange-50 to-pink-50 border border-orange-200 p-3 text-center fade-in">
          {{ partial "affiliate_blocks.html" . }}
        </div>
      {{ end }}
    {{ end }}
  </div>
{{ else }}
  <p class="text-gray-400 text-center mt-6">Album n√†y ch∆∞a c√≥ ·∫£nh th∆∞·ªùng.</p>
{{ end }}

<!-- ========================================================= -->
<!-- üíã B·ªò ·∫¢NH NUDE (D√ôNG PARTIAL RI√äNG) -->
<!-- ========================================================= -->
{{ partial "gallery_nude.html" (dict "page" $page "thumbsNude" $thumbsNude "nudes" $nudes) }}

<!-- ========================================================= -->
<!-- üí¨ SCRIPT X·ª¨ L√ù GALLERY + QU·∫¢NG C√ÅO + UNLOCK -->
<!-- ========================================================= -->
{{ partial "gallery_script.html" . }}

<!-- ========================================================= -->
<!-- üå∏ HI·ªÜU ·ª®NG & CSS PH·ª§ -->
<!-- ========================================================= -->
<style>
.fade-in {
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}
.fade-in-visible {
  opacity: 1;
  transform: translateY(0);
}
.col-span-2 {
  grid-column: span 2 / span 2;
}
</style>
