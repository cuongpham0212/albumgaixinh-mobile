<div class="album-grid grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
  {{ if gt (len .) 0 }}
    {{ range . }}
      <div class="album-card shadow hover:shadow-lg rounded overflow-hidden bg-white">
        <a href="{{ .RelPermalink }}">
          {{/* Ưu tiên thumbs > images > resources */}}
          {{ $imgs := .Params.thumbs }}
          {{ if not $imgs }}
            {{ $imgs = .Params.images }}
          {{ end }}
          {{ if not $imgs }}
            {{ $imgs = .Resources.ByType "image" }}
          {{ end }}

          {{ if gt (len $imgs) 0 }}
            {{ $firstItem := index $imgs 0 }}
            {{ $scratch := newScratch }}
            {{ $typeStr := printf "%T" $firstItem }}

            {{ if in $typeStr "string" }}
              {{ $scratch.Set "src" $firstItem }}
            {{ else }}
              {{ $scratch.Set "src" $firstItem.RelPermalink }}
            {{ end }}

            <img src="{{ $scratch.Get "src" }}" 
                 alt="Album {{ .Title }} - ảnh bìa" 
                 class="w-full h-40 object-cover" 
                 loading="lazy">
            <p class="text-center mt-2 text-sm">{{ len $imgs }} ảnh</p>
          {{ else }}
            <img src="{{ "images/cover.jpg" | absURL }}" 
                 alt="Album {{ .Title }} - mặc định" 
                 class="w-full h-40 object-cover" 
                 loading="lazy">
            <p class="text-center mt-2 text-sm">0 ảnh</p>
          {{ end }}
        </a>

        <div class="album-info text-center p-2">
          <h3 class="font-semibold">
            <a href="{{ .RelPermalink }}" class="hover:underline">
              {{ .Title }}
            </a>
          </h3>
        </div>
      </div>
    {{ end }}
  {{ else }}
    <p class="text-gray-500 text-sm col-span-full text-center">Chưa có bài viết.</p>
  {{ end }}
</div>
